<!-- Video Selection Modal -->
<script>
  function selectVideo(element){
    var publicID = element.childNodes[0].alt;
    var posterSrc = element.childNodes[0].src;

    $('#insertion-point').prepend('<img src="'+posterSrc+'" width = "188" height = "104"></img>')
    $('#selectModal').modal('hide');
    event.preventDefault();

    // extract .alt text (maybe also version) into variable, use jquery to get dom element of add new video to timeline, manipulate DOM element

  }
</script>

<div class="modal fade bd-example-modal-lg" id="selectModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Select a Video to Add</h4>
      </div>
      <div class="modal-body">
        <% if @intro_videos.present? %>
        <% @intro_videos.each do |disp| %>
          <a href="#" onclick="selectVideo(this)"><%= cl_image_tag(disp.cloud_video.public_id + ".jpg", :resource_type => "video", :version => disp.cloud_video.stored_version, :transformation => { :width => 100, :height => 72, :crop => :fill }) %></a>
          <% end %>
        <% else %>
        <% end %>
      </div>
    </div>
  </div>
</div>
<!-- End Modal -->

<!-- Video Edit Modal -->
<div class="modal fade bd-example-modal-sm" id="uploadModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content modal-sm">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Edit User Info</h4>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <%= simple_form_for @video_new do |f| %>
            <%= f.input :video_section, collection: ["Introduction", "Education", "Work Experience", "Hobbies", "Recommendations"], label: "Video Section", :include_blank => false %>
            <%= f.input :cloud_video %>
            <%= f.submit 'Update', class: 'btn btn-primary' %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- End Modal -->

<div class="container-fluid">
  <div class="row studio-bar">
    <div class="col-6 offset-1 studio-top">
    <h1>JobReel Studio</h1>
    <h3>Build your JobReel below. First, upload the videos that you'd like to use for each section in the left column and then, click and drag them to build your timeline below, one section at a time.</h3>
  </div>
<div class="col-2">&nbsp</div>
<div class="col-2 align-self-center">

          <button type="button" class='upload-button' data-toggle="modal" data-target="#uploadModal">+&nbsp&nbsp&nbspUPLOAD VIDEO</button>
  </div>
</div>
</div>

<div class="row studio-body justify-content-center">
  <div class="col-3">
  <div class="card vid-library padded5">
    <div class="card-block"> <!--Library Navigation Block-->
<div class="row nopadding">
  <div class="col-10 vid-library-top">
    PROFILE JOBREEL
  </div>
  <div class="col-2 text-center side-border">
    +
  </div>
</div>
</div>

<div class="card-block white">
  <div class="row vid-library-body-first">
    <div class="col-2 nopadding text-center">
    <%= image_tag 'intro-icon-lg.png' %>
  </div>
  <div class="col-9 vert-align padded7">
    <span id = "intro_collapse">Introduction</span>
  </div>

  <br /><br />
  <div id = "intro_hidden" class="col-10 offset-1 poster-display">
    <% if @intro_videos.present? %>
    <% @intro_videos.each do |disp| %>
      <%= cl_image_tag(disp.cloud_video.public_id + ".jpg", :resource_type => "video", :version => disp.cloud_video.stored_version, :transformation => { :width => 100, :height => 72, :crop => :fill }) %>
      <% end %>
    <% else %>
    <% end %>

      <%= image_tag "upload-video.png", data: {toggle: 'modal', target: '#uploadModal'} %>

  </div>
  </div>
  <hr>
  <div class="row vid-library-body">
    <div class="col-2 nopadding text-center">
    <%= image_tag 'education-icon-lg.png', id:"edu_icon" %>
  </div>
  <div class="col-9 vert-align padded7">
    <span id = "edu_collapse">Education</span>
</div>
  <br /><br />
  <div id ="edu_hidden" class="col-10 offset-1 poster-display" style="display: none;">
    <% if @education_videos.present? %>
    <% @education_videos.each do |disp| %>
      <%= cl_image_tag(disp.cloud_video.public_id + ".jpg", :resource_type => "video", :version => disp.cloud_video.stored_version, :transformation => { :width => 100, :height => 72, :crop => :fill }) %>
      <% end %>
    <% else %>
    <% end %>

      <%= image_tag "upload-video.png", data: {toggle: 'modal', target: '#uploadModal'} %>

  </div>
  </div>
    <hr>
  <div class="row vid-library-body">
    <div class="col-2 nopadding text-center">
    <%= image_tag 'work-icon-lg.png' %>
  </div>
  <div class="col-9 vert-align padded7">
    <span id="work_collapse">Work Experience</span>
</div>
  <br /><br />
  <div id="work_hidden" class="col-10 offset-1 poster-display" style="display: none;">
    <% if @work_videos.present? %>
    <% @work_videos.each do |disp| %>
      <%= cl_image_tag(disp.cloud_video.public_id + ".jpg", :resource_type => "video", :version => disp.cloud_video.stored_version, :transformation => { :width => 100, :height => 72, :crop => :fill }) %>
      <% end %>
    <% else %>
    <% end %>

      <%= image_tag "upload-video.png", data: {toggle: 'modal', target: '#uploadModal'} %>

  </div>
  </div>
    <hr>
  <div class="row vid-library-body">
    <div class="col-2 nopadding text-center">
    <%= image_tag 'hobbies-icon-lg.png' %>
  </div>
  <div class="col-9 vert-align padded7">
    <span id="hobby_collapse">Hobbies</span>
</div>
  <br /><br />
  <div id="hobby_hidden" class="col-10 offset-1 poster-display" style="display: none;">
    <% if @hobby_videos.present? %>
    <% @hobby_videos.each do |disp| %>
      <%= cl_image_tag(disp.cloud_video.public_id + ".jpg", :resource_type => "video", :version => disp.cloud_video.stored_version, :transformation => { :width => 100, :height => 72, :crop => :fill }) %>
      <% end %>
    <% else %>
    <% end %>

      <%= image_tag "upload-video.png", data: {toggle: 'modal', target: '#uploadModal'} %>

  </div>
  </div>
    <hr>
  <div class="row vid-library-body-last">
    <div class="col-2 nopadding text-center">
    <%= image_tag 'recs-icon-lg.png' %>
  </div>
  <div class="col-9 vert-align padded7">
    <span id="rec_collapse">Recommendations</span>
</div>
  <br /><br />
  <div id = "rec_hidden" class="col-10 offset-1 poster-display" style="display: none;">
    <% if @rec_videos.present? %>
    <% @rec_videos.each do |disp| %>
      <%= cl_image_tag(disp.cloud_video.public_id + ".jpg", :resource_type => "video", :version => disp.cloud_video.stored_version, :transformation => { :width => 100, :height => 72, :crop => :fill }) %>
      <% end %>
    <% else %>
    <% end %>

      <%= image_tag "upload-video.png", data: {toggle: 'modal', target: '#uploadModal'} %>

  </div>
  </div>
</div>
</div> <!--End of Video Library Card -->
</div>

<div class="col-5">
<div class="card studio-player nopadding">
    <div class="card-block studio-blend nopadding">
      <!-- <%= image_tag 'video-player-lg.png' %> -->
      <% if current_user.video.present? %>
        <%= cl_video_tag(@intro_videos.first.private_id, controls: true, transformation: @overlays) %>
      <% end %>
    </div>
</div>
<div class="card studio-timeline padded5">
  <div class="card-block white vert-align timeline-bot-bar">
    <h1>Introduction</h1>
  </div>
  <div class="card-block white timeline-instructions">
    <h3>From the left column where you've uploaded your videos, drag the ones you'd like to show viewers in the space provided below in the order you'd like them to appear.</h3>

  </div>
  <div class="card-block white timeline-workspace">
    <div class="row">
          <div class="col-4 text-center">
            <%= image_tag 'empty-frame.png', data: {toggle: 'modal', target: '#selectModal'}%>
          </div>
          <div class="col-8 no-pad-left">
            <div class="slider">
              <div class="scroll-left" id ="left1">&lt;
              </div>
              <div class="scroll-right" id="right1">&gt;
              </div>
              <div class="track" id="insertion-point">
              </div>
            </div>
          </div>
    </div>
  </div>
</div>

</div>

<script>
setInterval(function() {
    var left1 = parseInt($('#insertion-point').css('left'));

    if ($('#left1').is(":hover")) {
        $('#insertion-point').css('left', left1+2);
    }
    else if ($('#right1').is(":hover")) {
        $('#insertion-point').css('left', left1-2);
    }
}, 10);
</script>

<script>
$(document).ready(function(){
    $("#intro_collapse").click(function(){
        $("#intro_hidden").toggle(400);
    });
    $("#edu_collapse").click(function(){
        $("#edu_hidden").toggle(400);
        //$("#edu_icon").attr('src', '/assets/edu-icon-active.png');
    });
    $("#work_collapse").click(function(){
        $("#work_hidden").toggle(400);
    });
    $("#hobby_collapse").click(function(){
        $("#hobby_hidden").toggle(400);
    });
    $("#rec_collapse").click(function(){
        $("#rec_hidden").toggle(400);
    });
});
</script>
